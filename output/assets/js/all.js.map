{"version":3,"sources":["all.js"],"names":["console","clear","Vue","component","template","props","Array","type","Boolean","computed","statusClass","status","cordPrpos","Status","error","starClass","starStatus","methods","tempStarClick","$emit","app","el","data","AJAX_data","isLoading","stared","selectCounty","staredToLocalStoragePath","filterCounty","vm","reduceData","reduce","reduceObj","index","County","Object","keys","cardsData","filterCountyData","filter","SiteName","indexOf","unfilterCountyData","staredData","filterStaredData","getAjaxData","proxyServerPath","openDataApiPath","apiUrl","$","get","then","response","xhr","readyState","setTimeout","cardStarClick","item","log","siteNameIndex","splice","push","saveStaredToLocalStorage","localStorage","setItem","JSON","stringify","getLocalStorageStaredDB","ajaxDataResponse","localStorageData","parse","getItem","isArray","created"],"mappings":"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","file":"all.js","sourcesContent":["console.clear();\n\nVue.component('loadingComponent', {\n  template: '#loadingComponentTemplate'\n});\n\nVue.component('card-component', {\n  template: '#CardsTemplate',\n  props: {\n    'cord-prpos': { Array },\n    'star-status': { type: Boolean, default: false }\n  },\n  computed: {\n    statusClass() {\n      let status = this.cordPrpos.Status;\n      switch(status) {\n        case '良好':\n          return '';\n        case '普通':\n          return 'status-aqi2';\n        case '對敏感族群不健康':\n          return 'status-aqi3';\n        case '對所有族群不健康':\n          return 'status-aqi4';\n        case '非常不健康':\n          return 'status-aqi5';\n        case '危害':\n          return 'status-aqi6';\n        default:\n          console.error('Unknon Status: ' + status);\n          return '';\n      }      \n    },\n    starClass() {\n      return this.starStatus ? 'fas' : 'far';\n    }\n  },\n  methods: {\n    tempStarClick: function () {\n      // 指定元件本身觸發函式 tempStarClick ，將元件本身 cordPrpos 向外層傳\n      // console.log('tempStarClick()-cordPrpos', this.cordPrpos);\n      this.$emit('card-emit', this.cordPrpos);\n    },\n  } \n});\n\n\nvar app = new Vue({\n  el: '#app',\n  data: {\n    AJAX_data: [],\n    isLoading: true,\n    stared: [],\n    selectCounty: '',\n    staredToLocalStoragePath: 'vueStaredComponentList',\n  },\n  computed: {\n    filterCounty() {\n      const vm = this;\n\n      /*----------  寫法一  ----------*/\n      // const county = [];\n      // vm.AJAX_data.forEach((item) => { \n      //   // 比對值是 -1 就為 true，將\b\b該筆物件過濾後推 county 陣列裡。\n      //   if( county.indexOf(item.County) == -1 ){ county.push(item.County) };\n      // });\n      // return vm.locations = county;\n      /*----------  /寫法一  ----------*/\n      \n      /*----------  寫法二  ----------*/\n      // const county = [];\n      // vm.AJAX_data.forEach(function (item) {\n      //   // console.log('item.County', item.County);\n      //   county.push(item.County);\n      // });\n      // return vm.locations = Array.from(new Set(county));\n      /*----------  /寫法二  ----------*/\n      \n      /*----------  寫法三  ----------*/\n      // const county = [];\n      // vm.AJAX_data.forEach(function (item) {\n      //   // console.log('item.County', item.County);\n      //   county.push(item.County);\n      // });\n      // return vm.locations = [...new Set(county)];\n      /*----------  /寫法三  ----------*/\n\n      /*----------  寫法四  ----------*/\n      /**\n        * * .reduce 方法有二個部份，第一部份是函式，第二部份是預設資料。\n        * * 第一部份函式(prev, item, index)，函式 prev 參數使用的是第二部份的預設資料。\n        * * !reduceObj[County] 比對條件式立 (true)，也就是還沒有資料，資料是 reduceObj[County] = undefined ，陣列中的物件屬性值為數值 1。\n        * * !reduceObj[County] 比對不條件式立 (false)，也就是有資料，陣列中的物件屬性值為數值再加 1，這樣的方式主要只是要看出重復加總起來的縣市筆數。\n        * * Object.keys() 取物件方法將 Key 值 (屬性名稱) 轉為陣列，原本的物件資料屬性值 (加總縣市筆數) 不會帶入陣列中。\n      */\n      let reduceData = vm.AJAX_data.reduce( (reduceObj, { County }, index) => { \n        !reduceObj[County] ? (reduceObj[County]=1) : (reduceObj[County] = reduceObj[County]+1); \n        return reduceObj;\n      }, {});\n      return Object.keys( reduceData );\n      /*----------  /寫法四  ----------*/\n    },\n    cardsData() {\n      /*----------  寫法一  ----------*/\n      /** \n        * ! 這樣的寫法是可以將資料過濾，但 computed 不能將 VueJS 實\b\b體內的資料指向重置，例如： this.data=[] ，強將 VueJS 內的資料做修改成空的陣列，這樣在 computed 還是只會針對取進的資料來源做運處。\n        * * computed \b只做將進來 VueJS 實體資料做畫面處理，可以使用過濾、解構等的資料處理的方法將資料做單一流處理後輸出到畫面使用。\n      */\n\n      // let vm = this;\n      // const county = [];\n\n      // if( vm.selectCounty === '' || vm.selectCounty === '全部市區'){\n      //   vm.card_filterData = vm.AJAX_data\n      // } else {\n      //   vm.AJAX_data.forEach(function (item) {\n      //     if( vm.selectCounty === item.County){\n      //       vm.card_filterData = [];\n      //       vm.card_filterData.push(item);\n      //     }\n      //   });\n      // };\n      // return [...vm.card_filterData] ;\n      /*----------  /寫法一  ----------*/\n\n      /*----------  寫法二  ----------*/\n      const { AJAX_data, stared, selectCounty } = this;\n      const filterCountyData = AJAX_data.filter( function ({ County, SiteName }) {\n        // console.log('cardsData() - stared', stared);\n        // console.log('cardsData() - SiteName', SiteName);\n        // console.log('cardsData() - selectCounty', selectCounty);\n\n        // .indexOf() 尋找是否有符合的字串字元 | 0~n 由找的字串比對的字元數算起, -1 完全找不到相關的字元\n        // console.log('cardsData() - selectCounty.indexOf(SiteName) < 0 && County.indexOf(selectCounty) >= 0', selectCounty.indexOf(SiteName) < 0 && County.indexOf(selectCounty) >= 0);\n        \n        return stared.indexOf(SiteName) < 0 && County.indexOf(selectCounty) >= 0;\n      } );\n\n      const unfilterCountyData = AJAX_data.filter( function ({ County, SiteName }) {\n        /**\n          * ? 如果是在預設戴入或是在過濾完市區的選項下加入鄉鎮市區資料，例如：選 '基隆市 - 基隆' 加入關注鄉鎮市區 區塊中，在切到 '全部市區' 選項，在切回，此時下方的 [鄉鎮市區列表] 區塊就會在帶入 AJAX_data 的所有資料 (也就是未過濾的資料)，畫面會重復出現 '基隆市 - 基隆' 鄉鎮市區的資料在 [關注鄉鎮市區] 與 [鄉鎮市區列表] 二個區塊中。\n          * * 比對 VueJS 實體下的 stared 陣列內的物件字串與 AJAX_data 陣列內的物件中有 County 屬性，如果都沒有比對到的字串資料，在執行回傳\n        */\n\n        return stared.indexOf(SiteName) == -1 && County.indexOf(selectCounty) == -1;\n      });\n\n      return (selectCounty == '全部市區') ? unfilterCountyData : filterCountyData ;\n      /*----------  寫法二  ----------*/\n    },\n    staredData(){\n      const { AJAX_data, stared } = this;\n      const filterStaredData = AJAX_data.filter( function ({ SiteName }) {\n        // console.log('staredData() - SiteName', SiteName);\n        return stared.indexOf(SiteName) >= 0\n      } );\n      return filterStaredData;\n    },\n  },\n  methods: {\n    getAjaxData () {\n      const vm = this;\n      const proxyServerPath = 'https://cors-anywhere.herokuapp.com/';\n      const openDataApiPath = 'http://opendata2.epa.gov.tw/AQI.json';\n      const apiUrl = proxyServerPath + openDataApiPath;\n      $.get(apiUrl).then( function (response, status, xhr) {\n        // reponse 接到的 JSON 資料獎狀態\n        // console.log('response', response, 'status', status, 'xhr', xhr);\n        if( xhr.readyState === 4 ){\n          vm.AJAX_data = response;\n          setTimeout(() => {\n            // 讓讀取動畫基本要跑 2 秒\n            vm.isLoading = false;\n          }, 2000);\n          // vm.getLocalStorageStaredDB(response);\n        };\n      });\n    },\n    cardStarClick (item){\n      const vm = this;\n      // console.log('cardStarClick-item', item);\n      console.log('cardStarClick() - item.SiteName', item.SiteName);\n      \n      const siteNameIndex = vm.stared.indexOf(item.SiteName);\n      console.log('siteNameIndex', siteNameIndex);\n\n      /** \n        * * 比對函式所傳進來的區名， .indexOf() 方法比對 stared 變數全筆資料，尋找是否有符合的物件 | 2 找到, -1 找不到\n        * * 如果有找到條件成立 (2 >= 0)，將 stared 陣列資料內的物件區名對應索引值刪除\n        * * 如果條件不成立 (-1 >= 0)，將 stared 陣列資料內推上一筆函式帶入的物件區名\n      */\n      console.log('cardStarClick() - siteNameIndex >= 0', siteNameIndex >= 0);\n      siteNameIndex >= 0 ? vm.stared.splice(siteNameIndex, 1) : vm.stared.push(item.SiteName);\n\n      // 將點按事件所加入的資料 VueJS 實體內的 stared 陣列，觸發後同時將資料寫入 localStorage 裡。\n      vm.saveStaredToLocalStorage();\n    },\n    saveStaredToLocalStorage(){\n      const vm = this;\n      localStorage.setItem( vm.staredToLocalStoragePath, JSON.stringify(vm.stared));\n    },\n    getLocalStorageStaredDB(ajaxDataResponse){\n      const vm = this;\n      const localStorageData = JSON.parse(localStorage.getItem(vm.staredToLocalStoragePath));\n      \n      /*----------  寫法一  ----------*/\n      /**\n        * * 預要依賴於 getAjaxData () 裡透過取得 AJAX 資料後，將函式傳入參數 response -> ajaxDataResponse ，才能進行 getLocalStorageStaredDB () 函式內的比對資料的方法。\n        * * 無法使用在 VueJS 的 created 生命週期內，直接執行函式 getLocalStorageStaredDB()\n      */\n      // localStorageData.forEach(function(item){\n      //   ajaxDataResponse.forEach(function(el){\n      //     if(item === el.SiteName){\n      //       vm.stared.push(el.SiteName);\n      //     }\n      //   })\n      // });\n      /*----------  寫法一  ----------*/\n      \n      /*----------  寫法二  ----------*/\n      /**\n        * * 直接取出 localStorage 資料好解析 JSON 格式來比對資料\n        * * 不會有 AJAX 非同步取得資料的問題，可以直接將 getLocalStorageStaredDB() 函式用於 VueJS 的 created 生命週期與 getAjaxData () 內。\n      */\n      try {\n        (Array.isArray(localStorageData)) ? (vm.stared = localStorageData) : {} ;\n      } catch (localStorageData) {\n        console.error(localStorageData);\n      }\n      /*----------  /寫法二  ----------*/\n    },\n  },\n  created () {\n    const vm = this;\n    vm.getAjaxData();\n    vm.getLocalStorageStaredDB();\n    vm.isLoading = true;\n  }\n});"]}